<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Trabajadores - SALOME</title>
  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <!-- Animate.css para animaciones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <!-- Tu hoja de estilos personalizada -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Botón de cambio de tema -->
  <div class="theme-toggle" id="theme-toggle">
    <i class="material-icons" id="theme-icon">light_mode</i>
  </div>
  <!-- Sidebar - Material Dashboard Style -->
  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl fixed-start ms-3 bg-gradient-dark" id="sidenav-main">
    <div class="sidenav-header">
      <i class="material-icons opacity-10 cursor-pointer text-white position-absolute end-0 top-0 d-none d-xl-none">close</i>
      <a class="navbar-brand m-0" href="index.html">
        <img src="imagenes/logos/salome-logo.png" class="navbar-brand-img h-100" alt="Logo SALOME">
        <span class="ms-1 font-weight-bold text-white">SALOME</span>
      </a>
    </div>
    <hr class="horizontal light mt-0 mb-2">
    <div class="collapse navbar-collapse w-auto h-auto" id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link text-white active bg-gradient-primary" href="trabajadores.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">dashboard</i>
            </div>
            <span class="nav-link-text ms-1">Panel Principal</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="registros.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">person_add</i>
            </div>
            <span class="nav-link-text ms-1">Nuevo Trabajador</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="historicos.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">history</i>
            </div>
            <span class="nav-link-text ms-1">Datos Históricos</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="notificaciones.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">notifications</i>
            </div>
            <span class="nav-link-text ms-1">Notificaciones</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs text-white font-weight-bolder opacity-8">Configuración</h6>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="importar-datos.html">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">upload</i>
            </div>
            <span class="nav-link-text ms-1">Importar Datos</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="#">
            <div class="text-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="material-icons opacity-10">logout</i>
            </div>
            <span class="nav-link-text ms-1">Cerrar Sesión</span>
          </a>
        </li>
      </ul>
    </div>
  </aside>
  <!-- Main Content Wrapper -->
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="index.html">Inicio</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Panel de Trabajadores</li>
          </ol>
          <h6 class="font-weight-bolder mb-0">Monitoreo en tiempo real de trabajadores</h6>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group input-group-outline">
              <label class="form-label">Buscar trabajador...</label>
              <input type="text" class="form-control" id="buscarTrabajador">
            </div>
          </div>
          <ul class="navbar-nav justify-content-end">
            <li class="nav-item d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body font-weight-bold px-0">
                <i class="material-icons me-sm-1">account_circle</i>
                <span class="d-sm-inline d-none">Admin</span>
              </a>
            </li>
            <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
                <div class="sidenav-toggler-inner">
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                </div>
              </a>
            </li>
            <li class="nav-item dropdown pe-2 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="material-icons cursor-pointer">notifications</i>
                <span class="position-absolute top-5 start-100 translate-middle badge rounded-pill bg-danger">
                  3
                  <span class="visually-hidden">Notificaciones no leídas</span>
                </span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end px-2 py-3 me-sm-n4" aria-labelledby="dropdownMenuButton">
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <i class="material-icons text-danger">warning</i>
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">Alerta</span> Temperatura elevada
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="material-icons me-1">schedule</i>
                          hace 13 minutos
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <i class="material-icons text-warning">notifications</i>
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">Aviso</span> Frecuencia cardíaca fuera de rango
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="material-icons me-1">schedule</i>
                          hace 30 minutos
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <i class="material-icons text-success">check_circle</i>
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">Éxito</span> Sincronización completada
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="material-icons me-1">schedule</i>
                          hace 1 hora
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->
    <div class="container-fluid py-4">
      <!-- Filtros y estadísticas -->
      <div class="row mb-4">
        <div class="col-lg-12 position-relative z-index-2">
          <div class="card card-plain mb-4">
            <div class="card-body p-3">
              <div class="row">
                <div class="col-lg-6">
                  <div class="d-flex flex-column h-100">
                    <h2 class="font-weight-bolder mb-0">Panel de Trabajadores</h2>
                    <p class="mb-3">Monitorización de salud en tiempo real</p>
                    <div class="d-flex align-items-center mt-auto mb-4">
                      <div class="input-group input-group-outline me-2">
                        <select class="form-control" id="filtroEstado">
                          <option value="todos">Todos los estados</option>
                          <option value="normal">Estado Normal</option>
                          <option value="atencion">Atención Requerida</option>
                          <option value="alerta">Alerta</option>
                        </select>
                      </div>
                      <div class="input-group input-group-outline me-2">
                        <select class="form-control" id="filtroDepartamento">
                          <option value="todos">Todos los departamentos</option>
                          <option value="produccion">Producción</option>
                          <option value="administrativo">Administrativo</option>
                          <option value="mantenimiento">Mantenimiento</option>
                        </select>
                      </div>
                      <button class="btn bg-gradient-primary ms-auto mb-0" id="btnAplicarFiltros">
                        <i class="material-icons text-sm">filter_list</i>
                        Aplicar Filtros
                      </button>
                    </div>
                  </div>
                </div>
                <div class="col-lg-6 mt-lg-0 mt-4 text-end">
                  <div class="card bg-gradient-primary h-100">
                    <div class="card-body">
                      <div class="row">
                        <div class="col-4">
                          <div class="bg-gradient-dark shadow-dark border-radius-lg p-3 text-center h-100">
                            <h5 class="text-white text-uppercase font-weight-bold mb-0">Trabajadores</h5>
                            <h1 class="text-white mb-0" id="totalTrabajadores">0</h1>
                            <p class="text-white mb-0">Total activo</p>
                          </div>
                        </div>
                        <div class="col-4">
                          <div class="bg-gradient-success shadow-success border-radius-lg p-3 text-center h-100">
                            <h5 class="text-white text-uppercase font-weight-bold mb-0">Normal</h5>
                            <h1 class="text-white mb-0" id="trabajadoresNormales">0</h1>
                            <p class="text-white mb-0">Estado óptimo</p>
                          </div>
                        </div>
                        <div class="col-4">
                          <div class="bg-gradient-danger shadow-danger border-radius-lg p-3 text-center h-100">
                            <h5 class="text-white text-uppercase font-weight-bold mb-0">Alertas</h5>
                            <h1 class="text-white mb-0" id="trabajadoresAlerta">0</h1>
                            <p class="text-white mb-0">Atención</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Grid de tarjetas de trabajadores -->
      <div class="row mb-4">
        <!-- Las tarjetas de trabajadores se generarán dinámicamente con JavaScript -->
        <!-- No añadimos tarjetas estáticas aquí, serán creadas por trabajadores.js -->
      </div>
      
      <!-- Segunda fila con botón para cargar más -->
      <div class="row mb-4">
        <div class="col-12 text-center mt-4">
          <button class="btn bg-gradient-primary" id="cargarMas">
            <i class="material-icons me-2">add</i> Cargar Más Trabajadores
          </button>
        </div>
      </div>
      <!-- Métricas generales -->
      <div class="row mt-4">
        <div class="col-xl-6 col-md-12 mb-4">
          <div class="card">
            <div class="card-header p-3">
              <div class="row">
                <div class="col-md-8">
                  <h6 class="mb-0">Estado General de Salud</h6>
                  <p class="text-sm mb-0">Distribución del personal según estado de salud</p>
                </div>
                <div class="col-md-4 text-end">
                  <button class="btn btn-sm bg-gradient-primary mb-0">
                    <i class="material-icons text-sm">refresh</i>
                  </button>
                </div>
              </div>
            </div>
            <div class="card-body p-3">
              <div class="chart-container">
                <canvas id="estadoSaludChart" height="300"></canvas>
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-xl-6 col-md-12 mb-4">
          <div class="card">
            <div class="card-header p-3">
              <div class="row">
                <div class="col-md-8">
                  <h6 class="mb-0">Evolución Semanal</h6>
                  <p class="text-sm mb-0">Alertas detectadas en la última semana</p>
                </div>
                <div class="col-md-4 text-end">
                  <button class="btn btn-sm bg-gradient-primary mb-0">
                    <i class="material-icons text-sm">date_range</i>
                  </button>
                </div>
              </div>
            </div>
            <div class="card-body p-3">
              <div class="chart-container">
                <canvas id="alertasSemanalChart" height="300"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Enlaces rápidos -->
      <div class="row mt-4">
        <div class="col-md-4">
          <a href="registros.html" class="card card-link move-on-hover">
            <div class="card-body p-4 text-center">
              <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md mb-2">
                <i class="material-icons opacity-10">person_add</i>
              </div>
              <h5 class="text-gradient text-primary mb-0">Nuevo Trabajador</h5>
              <p class="mb-0 text-sm">Registrar nuevo trabajador en el sistema</p>
            </div>
          </a>
        </div>
        <div class="col-md-4">
          <a href="historicos.html" class="card card-link move-on-hover">
            <div class="card-body p-4 text-center">
              <div class="icon icon-shape bg-gradient-success shadow text-center border-radius-md mb-2">
                <i class="material-icons opacity-10">analytics</i>
              </div>
              <h5 class="text-gradient text-success mb-0">Ver Datos Históricos</h5>
              <p class="mb-0 text-sm">Consultar tendencias e históricos</p>
            </div>
          </a>
        </div>
        <div class="col-md-4">
          <a href="importar-datos.html" class="card card-link move-on-hover">
            <div class="card-body p-4 text-center">
              <div class="icon icon-shape bg-gradient-info shadow text-center border-radius-md mb-2">
                <i class="material-icons opacity-10">cloud_upload</i>
              </div>
              <h5 class="text-gradient text-info mb-0">Importar Datos</h5>
              <p class="mb-0 text-sm">Cargar datos históricos de Fitbit</p>
            </div>
          </a>
        </div>
      </div>
      <!-- Footer -->
      <footer class="footer py-4">
        <div class="container-fluid">
          <div class="row align-items-center justify-content-lg-between">
            <div class="col-lg-6 mb-lg-0 mb-4">
              <div class="copyright text-center text-sm text-muted text-lg-start">
                © <script>document.write(new Date().getFullYear())</script> SALOME - Sistema de Seguimiento, Apoyo y Localización para la Optimización, Monitorización y Evaluación de la Salud
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </main>

  <!-- Tooltip Global para mostrar información interactiva -->
  <div id="tooltip" class="tooltip">
    <img id="tooltip-icon" class="tooltip-img" src="" alt="Icono">
    <h4 id="tooltip-title"></h4>
    <p id="tooltip-text"></p>
    <video id="tooltip-video" class="tooltip-video" controls></video>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js para las gráficas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
  
  <!-- Script para tema oscuro/claro -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Toggle de tema
      const themeToggle = document.getElementById('theme-toggle');
      const themeIcon = document.getElementById('theme-icon');
      
      // Función para alternar entre temas
      function toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        if (currentTheme === 'dark') {
          document.documentElement.setAttribute('data-theme', 'light');
          themeIcon.textContent = 'dark_mode';
          localStorage.setItem('theme', 'light');
        } else {
          document.documentElement.setAttribute('data-theme', 'dark');
          themeIcon.textContent = 'light_mode';
          localStorage.setItem('theme', 'dark');
        }
      }
      
      // Comprobar tema guardado
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        document.documentElement.setAttribute('data-theme', savedTheme);
        themeIcon.textContent = savedTheme === 'dark' ? 'light_mode' : 'dark_mode';
      }
      
      // Añadir evento de clic
      themeToggle.addEventListener('click', toggleTheme);
      
      // Sidenav toggle para móviles
      const iconNavbarSidenav = document.getElementById('iconNavbarSidenav');
      const sidenav = document.getElementById('sidenav-main');
      
      if (iconNavbarSidenav) {
        iconNavbarSidenav.addEventListener('click', function() {
          sidenav.classList.toggle('show');
        });
      }
    });
  </script>
  
  <!-- Script principal para la página trabajadores.js -->
  <script src="trabajadores.js"></script>
</body>
</html>
